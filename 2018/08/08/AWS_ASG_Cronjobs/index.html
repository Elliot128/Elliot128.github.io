<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Running cron jobs on AWS ASG instances | Elliots Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="When processes must be ran at a set interval on an machine, cron is popular tool for the job. But, what if the process must be ran only once per autoscale group? One solution on aws is to install the">
<meta property="og:type" content="article">
<meta property="og:title" content="Running cron jobs on AWS ASG instances">
<meta property="og:url" content="http://elliotkozil.com/2018/08/08/AWS_ASG_Cronjobs/index.html">
<meta property="og:site_name" content="Elliots Blog">
<meta property="og:description" content="When processes must be ran at a set interval on an machine, cron is popular tool for the job. But, what if the process must be ran only once per autoscale group? One solution on aws is to install the">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2018-08-09T05:59:07.689Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Running cron jobs on AWS ASG instances">
<meta name="twitter:description" content="When processes must be ran at a set interval on an machine, cron is popular tool for the job. But, what if the process must be ran only once per autoscale group? One solution on aws is to install the">
  
    <link rel="alternate" href="/atom.xml" title="Elliots Blog" type="application/atom+xml">
  
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" integrity="sha384-XdYbMnZ/QjLh6iI4ogqCTaIjrFk87ip+ekIjefZch0Y+PvJ8CDYtEs1ipDmPorQ+" crossorigin="anonymous">

  <link rel="stylesheet" href="/css/styles.css">
  

</head>

<body>
  <nav class="navbar navbar-inverse">
  <div class="container">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#main-menu-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="main-menu-navbar">
      <ul class="nav navbar-nav">
        
          <li><a class=""
                 href="/index.html">Home</a></li>
        
          <li><a class=""
                 href="/archives/">Archives</a></li>
        
      </ul>

      <!--
      <ul class="nav navbar-nav navbar-right">
        
          <li><a href="/atom.xml" title="RSS Feed"><i class="fa fa-rss"></i></a></li>
        
      </ul>
      -->
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>

  <div class="container">
    <div class="blog-header">
  <h1 class="blog-title">Elliots Blog</h1>
  
</div>

    <div class="row">
        <div class="col-sm-8 blog-main">
          <article id="post-AWS_ASG_Cronjobs" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 class="article-title" itemprop="name">
      Running cron jobs on AWS ASG instances
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/2018/08/08/AWS_ASG_Cronjobs/" class="article-date"><time datetime="2018-08-08T20:02:00.000Z" itemprop="datePublished">2018-08-08</time></a>
</div>

    <div class="article-author">Elliot Kozil</div>
    

  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>When processes must be ran at a set interval on an machine, cron is popular tool for the job. But, what if the process must be ran only once per autoscale group?</p>
<p>One solution on aws is to install the SSM agent on all instances, implement the script in an SSM document, then use a lamdba function to invoke that script on a target instance.</p>
<p>If you donâ€™t already use these services, you can accomplish the same using just <code>cron</code>, <code>curl</code>, and the <code>aws</code> cli tools. We will write a script that invokes its arg on only one server in the asg.</p>
<script src="https://gist.github.com/Elliot128/6fc5e2d38b62df5ac077e47e07ee5240.js"></script>


<p>We can then run the job as an arg to this script in crontab:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">* * * * * /once_per_asg.sh /job.sh</span><br></pre></td></tr></table></figure></p>

      
    </div>

    
      

    

    <footer class="article-footer">
      <a data-url="http://elliotkozil.com/2018/08/08/AWS_ASG_Cronjobs/" data-id="cjknctef90000o0vs9w9nzrz7" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
      

    </footer>
  </div>
  
    

  
</article>




        </div>
        <div class="col-sm-3 col-sm-offset-1 blog-sidebar">
          
  <div class="sidebar-module sidebar-module-inset">
  <h4>About</h4>
  <p>Etiam porta <em>sem malesuada magna</em> mollis euismod. Cras mattis consectetur purus sit amet fermentum. Aenean lacinia bibendum nulla sed consectetur.</p>

</div>


  


  


  

  
  <div class="sidebar-module">
    <h4>Archives</h4>
    <ul class="sidebar-module-list"><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2018/08/">August 2018</a><span class="sidebar-module-list-count">1</span></li></ul>
  </div>



  
  <div class="sidebar-module">
    <h4>Recents</h4>
    <ul class="sidebar-module-list">
      
        <li>
          <a href="/2018/08/08/AWS_ASG_Cronjobs/">Running cron jobs on AWS ASG instances</a>
        </li>
      
    </ul>
  </div>



        </div>
    </div>
  </div>
  <footer class="blog-footer">
  <div class="container">
    <div id="footer-info" class="inner">
      &copy; 2018 Elliot Kozil<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

  

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" integrity="sha384-8gBf6Y4YYq7Jx97PIqmTwLPin4hxIzQw5aDmUg/DDhul9fFpbbLcLh3nTIIDJKhx" crossorigin="anonymous"></script>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>



<script src="/js/script.js"></script>

</body>
</html>
